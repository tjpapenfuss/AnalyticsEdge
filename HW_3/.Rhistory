setwd("~/AnalyticsEdge/AnalyticsEdge/HW_3")
library(caTools)
data = read.csv("framingham.csv")
# Set CHD as a factor variable. This is the dependent variable (y).
data$TenYearCHD <- factor(data$TenYearCHD)
# Set your additional factor variables.
data$male <- factor(data$male)
data$currentSmoker <- factor(data$currentSmoker)
data$BPMeds <- factor(data$BPMeds)
data$prevalentStroke <- factor(data$prevalentStroke)
data$prevalentHyp <- factor(data$prevalentHyp)
data$diabetes <- factor(data$diabetes)
set.seed(31)
N <- nrow(data)
idx = sample.split(data$TenYearCHD, 0.75)
train <- data[idx,]
test = data[!idx,]
str(train)
# --------------------------------------------------------------------------------- #
#### Problem 2f
library(caret)
library(InformationValue)
library(ISLR)
model_train <- glm(TenYearCHD ~.,family=binomial, train)
predicted = predict(model_train, data = train, type="response")
optimal = 0.08
predicted <- ifelse(predicted>=optimal, 1, 0)
train$TenYearCHD
confusionMatrix(train$TenYearCHD, as.factor(predicted))
summarise(train)
roc_score=roc(train$TenYearCHD, predicted) #AUC score
library(tidyverse)
library(ggrepel)
library(caTools)
library(caret)
library(ROCR)
library(ggplot2)
library(splines)
library(ISLR)
library(caret)
library(leaps)
library(gridExtra)
library(dplyr)
library(tidyr)
library(lars)
library(gbm)
library(glmnet)
library(ggcorrplot)
library(Hmisc)
summarise(train)
# just some extra testing to see a count of all people that get CHD.
library("dplyr")
dplyr::count(train, TenYearCHD)
roc_score=roc(train$TenYearCHD, predicted) #AUC score
# --------------------------------------------------------------------------------- #
#### Problem 2f
library(caret)
roc_score=roc(train$TenYearCHD, predicted) #AUC score
library(pROC)
roc_score=roc(train$TenYearCHD, predicted) #AUC score
plot(roc_score ,main ="ROC curve -- Logistic Regression ")
roc_score
confusionMatrix(train$TenYearCHD, as.factor(predicted))
model_train_three <- glm(TenYearCHD ~age+gender+sysBP,family=binomial, train)
model_train_three <- glm(TenYearCHD ~age+male+sysBP,family=binomial, train)
summary(model_train_three)
predicted = predict(model_train, data = train, type="response")
predicted = predict(model_train_three, data = train, type="response")
predicted <- ifelse(predicted>=optimal, 1, 0)
confusionMatrix(train$TenYearCHD, as.factor(predicted))
