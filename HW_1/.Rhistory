test_set = subset(dataset, split == FALSE)
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
View(dataset)
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
print(dataset)
set.seed(123)
split = sample.split(dataset$Temp, Year < 1995)
split = sample.split(dataset$Temp, dataset$Year < 1995)
split = sample.split(dataset$Temp, 0.7)
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
print(dataset)
set.seed(123)
split = sample.split(dataset$Temp, f = (dataset$Year < 1995))
split = sample.split(dataset$Temp, f = dataset$Year)
#split = sample.split(dataset$Temp, 0.7)
split = sample.split(dataset, f = dataset$Year)
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
print(dataset)
set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
split = sample.split(dataset, f = dataset$Year)
training_set = subset(dataset, split < 1995)
View(training_set)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
split = sample.split(dataset, f = dataset$Year)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
split(dataset, f = dataset$Year)
training_set = subset(dataset, split < 1995)
test_set = subset(dataset, split == FALSE)
View(test_set)
View(training_set)
trn = dataset[dataset$Year <= 1995, ]
View(trn)
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 1995, ]
test_set = dataset[dataset$Year > 1995, ]
View(trn)
View(dataset)
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 1998, ]
test_set = dataset[dataset$Year > 1998, ]
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 1999, ]
test_set = dataset[dataset$Year > 1999, ]
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2000, ]
test_set = dataset[dataset$Year > 2000, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
View(dataset)
View(test_set)
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2004, ]
test_set = dataset[dataset$Year > 2004, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2004, ]
test_set = dataset[dataset$Year > 2004, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
cor(test_set$Temp, test_predict$Temp)^2
dataset <- mtcars
head(dataset, 6)
# Import the dataset
dataset = read.csv('climate_change.csv')
round(cor(training_set), digits = 2) # rounded to 2 decimals
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2004, ]
test_set = dataset[dataset$Year > 2004, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
round(cor(training_set), digits = 2) # rounded to 2 decimals
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
cor(test_set, test_predict)^2
#round(cor(training_set), digits = 2) # rounded to 2 decimals
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
summary(test_predict)
cor(test_set, test_predict)^2
cor(test_set$Temp, test_predict)^2
test_predict
View(dataset)
View(test_set)
#round(cor(training_set), digits = 2) # rounded to 2 decimals
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
#regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
#round(cor(training_set), digits = 2) # rounded to 2 decimals
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
#regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
#round(cor(training_set), digits = 2) # rounded to 2 decimals
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
#round(cor(training_set), digits = 2) # rounded to 2 decimals
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2002, ]
test_set = dataset[dataset$Year > 2002, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
#round(cor(training_set), digits = 2) # rounded to 2 decimals
#1. MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)
#MAPE = function(y_actual,y_predict){
#  mean(abs((y_actual-y_predict)/y_actual))*100
#}
#2. R SQUARED error metric -- Coefficient of Determination
#RSQUARE = function(y_actual,y_predict){
#  cor(y_actual,y_predict)^2
#}
sse
sse = sum((fitted(test_predict) - test_set$Temp)^2)
sse = sum((fitted(regressor) - test_set$Temp)^2)
sse = sum((fitted(regressor) - training_set$Temp)^2)
sse
test_predict-test_set$Temp)^2)
sum((test_predict-test_set$Temp)^2)
sse = sum((fitted(regressor) - training_set$Temp)^2)
sse
sse = sum((fitted(test_predict) - test_set$Temp)^2)
sum((fitted(test_predict) - test_set$Temp)^2)
sum((test_predict-test_set$Temp)^2)
sum((test_set$Temp - mean(test_set$Temp)) ^ 2)  ## total sum of squares
sum((test_predict-test_set$Temp)^2)
tss = su
rss = sum((test_predict-test_set$Temp)^2)
tss = sum((test_set$Temp - mean(test_set$Temp)) ^ 2)  ## total sum of squares
1 - rss/tss
regss = sum((test_predict - mean(test_predict)) ^ 2) ## regression sum of squares
1 - regss/tss
regss/tss
rsquared=Rsquared(test_predict,test_set,test_set$Temp)
# dataset = dataset[, 2:3]
source("RFunctions.R")
Rsquared <- function(lmfit,newdf,y){
yhat <- predict(lmfit,newdata=newdf)
RSS <- sum((y - yhat)^2)
TSS <- sum((y - mean(y))^2)
rsquared <-1 - (RSS/TSS)
rsquared
}
rsquared=Rsquared(test_predict,test_set,test_set$Temp)
rsquared=Rsquared(test_predict,test_set,test_set$Temp)
RSS <- sum((test_set$Temp - test_predict)^2)
TSS <- sum((test_set$Temp - mean(test_set$Temp))^2)
rsquared <-1 - (RSS/TSS)
rsquared
regss/tss
1 - rss/tss
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
plot(test_predict, test_set$Temp)
plot(test_set$Temp, test_predict)
summary(regressor)
plot(training_set$N2O, training_set$Temp)
plot(regressor)
abline(regressor)
plot(training_set$N2O, training_set$Temp)
abline(regressor)
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2002, ]
test_set = dataset[dataset$Year > 2002, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2002, ]
test_set = dataset[dataset$Year > 2002, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
#regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
rss = sum((test_predict-test_set$Temp)^2)
tss = sum((test_set$Temp - mean(test_set$Temp)) ^ 2)  ## total sum of squares
1 - rss/tss
RSS <- sum((test_set$Temp - test_predict)^2)
TSS <- sum((test_set$Temp - mean(test_set$Temp))^2)
rsquared <-1 - (RSS/TSS)
rsquared
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
#regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
RSS <- sum((test_set$Temp - test_predict)^2)
TSS <- sum((test_set$Temp - mean(test_set$Temp))^2)
rsquared <-1 - (RSS/TSS)
rsquared
sum((fitted(test_predict) - test_set$Temp)^2)
# Import the dataset
dataset = read.csv('climate_change.csv')
# dataset = dataset[, 2:3]
# Split data set into test and training set
library(caTools)
#set.seed(123)
#split = sample.split(dataset$Temp, 0.7)
#training_set = subset(dataset, split == TRUE)
#test_set = subset(dataset, split == FALSE)
training_set = dataset[dataset$Year <= 2003, ]
test_set = dataset[dataset$Year > 2003, ]
#regressor = lm(formula = Temp ~ CO2 + CH4 + N2O + CFC_11 + CFC_12 + TSI + Aerosols + MEI, data = training_set)
regressor = lm(formula = Temp ~ N2O + TSI + Aerosols + MEI, data = training_set)
summary(regressor)
summary(regressor)$r.squared
test_predict = predict(regressor, newdata = test_set)
summary(test_predict)
test_predict
cor(test_set$Temp, test_predict)^2
RSS <- sum((test_set$Temp - test_predict)^2)
TSS <- sum((test_set$Temp - mean(test_set$Temp))^2)
rsquared <-1 - (RSS/TSS)
rsquared
